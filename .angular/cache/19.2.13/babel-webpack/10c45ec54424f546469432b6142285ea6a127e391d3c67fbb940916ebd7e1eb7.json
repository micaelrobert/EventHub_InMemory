{"ast":null,"code":"import { __decorate, __param } from \"tslib\";\nimport { Component, Inject } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { Validators, ReactiveFormsModule } from \"@angular/forms\";\nimport { MatDialogModule, MAT_DIALOG_DATA } from \"@angular/material/dialog\";\nimport { MatFormFieldModule } from \"@angular/material/form-field\";\nimport { MatInputModule } from \"@angular/material/input\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatIconModule } from \"@angular/material/icon\";\nimport { MatSelectModule } from \"@angular/material/select\";\nlet ComprarIngressoDialogComponent = class ComprarIngressoDialogComponent {\n  data;\n  fb;\n  ingressosService;\n  notificationService;\n  dialogRef;\n  evento;\n  compraForm;\n  quantidades = [];\n  valorTotal = 0;\n  comprando = false;\n  constructor(data, fb, ingressosService, notificationService, dialogRef) {\n    this.data = data;\n    this.fb = fb;\n    this.ingressosService = ingressosService;\n    this.notificationService = notificationService;\n    this.dialogRef = dialogRef;\n    this.evento = data.evento;\n    this.gerarQuantidades();\n    this.criarForm();\n  }\n  gerarQuantidades() {\n    const maxQuantidade = Math.min(this.evento.ingressosDisponiveis, 10);\n    this.quantidades = Array.from({\n      length: maxQuantidade\n    }, (_, i) => i + 1);\n  }\n  criarForm() {\n    this.compraForm = this.fb.group({\n      nomeComprador: [\"\", [Validators.required, Validators.minLength(3)]],\n      emailComprador: [\"\", [Validators.required, Validators.email]],\n      telefoneComprador: [\"\", [Validators.required, Validators.pattern(/^\\(\\d{2}\\) \\d{4,5}-\\d{4}$/)]],\n      quantidade: [1, [Validators.required, Validators.min(1)]]\n    });\n    this.calcularTotal();\n  }\n  calcularTotal() {\n    const quantidade = this.compraForm.get(\"quantidade\")?.value || 0;\n    this.valorTotal = quantidade * this.evento.precoIngresso;\n  }\n  confirmarCompra() {\n    if (this.compraForm.invalid) {\n      this.notificationService.error(\"Preencha todos os campos corretamente\");\n      return;\n    }\n    this.comprando = true;\n    const compra = {\n      eventoId: this.evento.id,\n      nomeComprador: this.compraForm.value.nomeComprador,\n      emailComprador: this.compraForm.value.emailComprador,\n      telefoneComprador: this.compraForm.value.telefoneComprador,\n      quantidade: this.compraForm.value.quantidade\n    };\n    this.ingressosService.comprarIngresso(compra).subscribe({\n      next: response => {\n        this.comprando = false;\n        if (response.sucesso) {\n          this.notificationService.success(`Compra realizada! Nº do ingresso: ${response.dados?.codigo}`);\n          this.dialogRef.close({\n            success: true,\n            quantidade: compra.quantidade\n          });\n        } else {\n          this.notificationService.error(response.mensagem || \"Erro ao processar compra\");\n        }\n      },\n      error: err => {\n        this.comprando = false;\n        this.notificationService.error(\"Erro na comunicação com o servidor\");\n        console.error(\"Erro na compra:\", err);\n      }\n    });\n  }\n  cancelar() {\n    this.dialogRef.close({\n      success: false\n    });\n  }\n};\nComprarIngressoDialogComponent = __decorate([Component({\n  selector: \"app-comprar-ingresso-dialog\",\n  standalone: true,\n  imports: [CommonModule, ReactiveFormsModule, MatDialogModule, MatFormFieldModule, MatInputModule, MatButtonModule, MatIconModule, MatSelectModule],\n  templateUrl: \"./comprar-ingresso-dialog.component.html\",\n  styleUrls: [\"./comprar-ingresso-dialog.component.css\"]\n}), __param(0, Inject(MAT_DIALOG_DATA))], ComprarIngressoDialogComponent);\nexport { ComprarIngressoDialogComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}