{"ast":null,"code":"import { CommonModule, formatDate } from \"@angular/common\";\nimport { ReactiveFormsModule, Validators } from \"@angular/forms\";\nimport { MatFormFieldModule } from \"@angular/material/form-field\";\nimport { MatInputModule } from \"@angular/material/input\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatCardModule } from \"@angular/material/card\";\nimport { MatDatepickerModule } from \"@angular/material/datepicker\";\nimport { MatNativeDateModule } from \"@angular/material/core\";\nimport { MatSlideToggleModule } from \"@angular/material/slide-toggle\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"./../services/eventos.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/material/form-field\";\nimport * as i6 from \"@angular/material/input\";\nimport * as i7 from \"@angular/material/button\";\nimport * as i8 from \"@angular/material/card\";\nimport * as i9 from \"@angular/material/datepicker\";\nimport * as i10 from \"@angular/material/slide-toggle\";\nfunction EventoFormComponent_img_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 23);\n  }\n  if (rf & 2) {\n    let tmp_2_0;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"src\", (tmp_2_0 = ctx_r1.form.get(\"imagemUrl\")) == null ? null : tmp_2_0.value, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction EventoFormComponent_div_49_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24)(1, \"mat-slide-toggle\", 25);\n    i0.ɵɵtext(2, \" Evento Ativo \");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport let EventoFormComponent = /*#__PURE__*/(() => {\n  class EventoFormComponent {\n    fb;\n    eventoService;\n    router;\n    route;\n    form;\n    eventId = null;\n    isEditMode = false;\n    constructor(fb, eventoService, router, route) {\n      this.fb = fb;\n      this.eventoService = eventoService;\n      this.router = router;\n      this.route = route;\n    }\n    ngOnInit() {\n      this.form = this.fb.group({\n        nome: [\"\", [Validators.required, Validators.minLength(3)]],\n        descricao: [\"\", [Validators.required, Validators.minLength(10)]],\n        dataEvento: [null, [Validators.required]],\n        horaEvento: ['09:00', [Validators.required]],\n        local: [\"\", [Validators.required, Validators.minLength(5)]],\n        precoIngresso: [0, [Validators.required, Validators.min(0)]],\n        capacidadeMaxima: [1, [Validators.required, Validators.min(1)]],\n        ativo: [true]\n      });\n      const idParam = this.route.snapshot.paramMap.get('id');\n      if (idParam) {\n        this.isEditMode = true;\n        this.eventId = +idParam;\n        this.form.controls['ativo'].enable();\n        this.carregarDadosDoEvento(this.eventId);\n      } else {\n        this.isEditMode = false;\n        this.form.controls['ativo'].disable();\n      }\n    }\n    carregarDadosDoEvento(id) {\n      // Supondo que seu serviço tenha um método getEventoById que retorna ApiResponse<Evento>\n      this.eventoService.getEvento(id).subscribe({\n        next: response => {\n          if (response.sucesso && response.dados) {\n            const evento = response.dados;\n            this.form.patchValue({\n              nome: evento.nome,\n              descricao: evento.descricao,\n              dataEvento: evento.dataEvento,\n              local: evento.local,\n              precoIngresso: evento.precoIngresso,\n              capacidadeMaxima: evento.capacidadeMaxima,\n              ativo: evento.ativo\n            });\n            if (evento.dataEvento) {\n              this.form.controls['horaEvento'].setValue(formatDate(evento.dataEvento, 'HH:mm', 'en-US'));\n            }\n          } else {\n            console.error(\"Erro ao buscar dados do evento:\", response.mensagem);\n            this.router.navigate(['/eventos']);\n          }\n        },\n        error: err => {\n          console.error(\"Erro na requisição para buscar evento:\", err);\n          this.router.navigate(['/eventos']);\n        }\n      });\n    }\n    onSubmit() {\n      if (this.form.invalid) {\n        console.log(\"Formulário inválido.\");\n        this.form.markAllAsTouched();\n        return;\n      }\n      const formValues = this.form.value;\n      const dataSelecionada = new Date(formValues.dataEvento);\n      const [horas, minutos] = formValues.horaEvento.split(':').map(Number);\n      const dataEventoCompleta = new Date(dataSelecionada.getFullYear(), dataSelecionada.getMonth(), dataSelecionada.getDate(), horas, minutos);\n      // --- ADICIONADOS OS CONSOLE.LOGS PARA DEBUG ---\n      console.log(\"--- DEBUG SUBMIT (EDIÇÃO OU CRIAÇÃO) ---\");\n      console.log(\"Valor dataEvento do form (original):\", formValues.dataEvento);\n      console.log(\"Valor horaEvento do form:\", formValues.horaEvento);\n      console.log(\"Data selecionada (após new Date):\", dataSelecionada.toISOString(), dataSelecionada);\n      console.log(\"Horas parseadas:\", horas, \"Minutos parseados:\", minutos);\n      console.log(\"DataEventoCompleta a ser enviada (objeto Date):\", dataEventoCompleta);\n      console.log(\"DataEventoCompleta a ser enviada (ISO String):\", dataEventoCompleta.toISOString());\n      // --- FIM DOS CONSOLE.LOGS ---\n      if (this.isEditMode && this.eventId !== null) {\n        const eventoAtualizado = {\n          id: this.eventId,\n          nome: formValues.nome,\n          descricao: formValues.descricao,\n          dataEvento: dataEventoCompleta,\n          local: formValues.local,\n          precoIngresso: formValues.precoIngresso,\n          capacidadeMaxima: formValues.capacidadeMaxima,\n          ativo: formValues.ativo\n        };\n        // --- CONSOLE.LOG DO PAYLOAD DE ATUALIZAÇÃO ---\n        console.log(\"Payload enviado para atualizarEvento:\", eventoAtualizado);\n        // --- FIM DO CONSOLE.LOG ---\n        this.eventoService.atualizarEvento(this.eventId, eventoAtualizado).subscribe({\n          next: () => {\n            console.log(\"Evento atualizado com sucesso!\");\n            this.router.navigate(['/eventos']);\n          },\n          error: err => {\n            console.error(\"Erro ao atualizar evento:\", err);\n          }\n        });\n      } else {\n        const novoEvento = {\n          nome: formValues.nome,\n          descricao: formValues.descricao,\n          dataEvento: dataEventoCompleta,\n          local: formValues.local,\n          precoIngresso: formValues.precoIngresso,\n          capacidadeMaxima: formValues.capacidadeMaxima\n        };\n        // --- CONSOLE.LOG DO PAYLOAD DE CRIAÇÃO ---\n        console.log(\"Payload enviado para criarEvento:\", novoEvento);\n        // --- FIM DO CONSOLE.LOG ---\n        this.eventoService.criarEvento(novoEvento).subscribe({\n          next: () => {\n            console.log(\"Evento criado com sucesso!\");\n            this.router.navigate(['/eventos']);\n          },\n          error: err => {\n            console.error(\"Erro ao criar evento:\", err);\n          }\n        });\n      }\n    }\n    onCancel() {\n      this.router.navigate(['/eventos']);\n    }\n    static ɵfac = function EventoFormComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || EventoFormComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.EventosService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i3.ActivatedRoute));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: EventoFormComponent,\n      selectors: [[\"app-evento-form\"]],\n      decls: 55,\n      vars: 9,\n      consts: [[\"picker\", \"\"], [1, \"container\"], [1, \"grid-layout\"], [1, \"event-form\"], [1, \"form-card\"], [\"alt\", \"Imagem do Evento\", \"class\", \"evento-imagem animate-image\", 3, \"src\", 4, \"ngIf\"], [3, \"ngSubmit\", \"formGroup\"], [\"appearance\", \"fill\", 1, \"full-width\"], [\"matInput\", \"\", \"formControlName\", \"nome\", \"placeholder\", \"Ex: Show de Rock\"], [\"matInput\", \"\", \"formControlName\", \"descricao\", \"placeholder\", \"Descreva os detalhes do evento...\"], [1, \"form-row\"], [\"appearance\", \"fill\", 1, \"form-field-half\"], [\"matInput\", \"\", \"formControlName\", \"dataEvento\", 3, \"matDatepicker\"], [\"matSuffix\", \"\", 3, \"for\"], [\"matInput\", \"\", \"type\", \"time\", \"formControlName\", \"horaEvento\"], [\"matInput\", \"\", \"formControlName\", \"local\", \"placeholder\", \"Ex: Est\\u00E1dio Maracan\\u00E3\"], [\"matInput\", \"\", \"type\", \"number\", \"formControlName\", \"precoIngresso\", \"placeholder\", \"50.00\"], [\"matInput\", \"\", \"type\", \"number\", \"formControlName\", \"capacidadeMaxima\", \"placeholder\", \"1000\"], [\"matInput\", \"\", \"formControlName\", \"imagemUrl\", \"placeholder\", \"https://imagem.com/evento.jpg\"], [\"class\", \"toggle-section\", 4, \"ngIf\"], [\"align\", \"end\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"type\", \"submit\", 3, \"disabled\"], [\"mat-stroked-button\", \"\", \"color\", \"warn\", \"type\", \"button\", 3, \"click\"], [\"alt\", \"Imagem do Evento\", 1, \"evento-imagem\", \"animate-image\", 3, \"src\"], [1, \"toggle-section\"], [\"formControlName\", \"ativo\", \"color\", \"primary\"]],\n      template: function EventoFormComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"div\", 1)(1, \"div\", 2)(2, \"div\", 3)(3, \"mat-card\", 4)(4, \"mat-card-header\")(5, \"mat-card-title\");\n          i0.ɵɵtext(6);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(7, \"mat-card-subtitle\");\n          i0.ɵɵtext(8);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(9, EventoFormComponent_img_9_Template, 1, 1, \"img\", 5);\n          i0.ɵɵelementStart(10, \"mat-card-content\")(11, \"form\", 6);\n          i0.ɵɵlistener(\"ngSubmit\", function EventoFormComponent_Template_form_ngSubmit_11_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onSubmit());\n          });\n          i0.ɵɵelementStart(12, \"mat-form-field\", 7)(13, \"mat-label\");\n          i0.ɵɵtext(14, \"Nome do Evento\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(15, \"input\", 8);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(16, \"mat-form-field\", 7)(17, \"mat-label\");\n          i0.ɵɵtext(18, \"Descri\\u00E7\\u00E3o\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(19, \"textarea\", 9);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(20, \"div\", 10)(21, \"mat-form-field\", 11)(22, \"mat-label\");\n          i0.ɵɵtext(23, \"Data do Evento\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(24, \"input\", 12)(25, \"mat-datepicker-toggle\", 13)(26, \"mat-datepicker\", null, 0);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(28, \"mat-form-field\", 11)(29, \"mat-label\");\n          i0.ɵɵtext(30, \"Hora do Evento\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(31, \"input\", 14);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(32, \"mat-form-field\", 7)(33, \"mat-label\");\n          i0.ɵɵtext(34, \"Local\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(35, \"input\", 15);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(36, \"div\", 10)(37, \"mat-form-field\", 11)(38, \"mat-label\");\n          i0.ɵɵtext(39, \"Pre\\u00E7o do Ingresso (R$)\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(40, \"input\", 16);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(41, \"mat-form-field\", 11)(42, \"mat-label\");\n          i0.ɵɵtext(43, \"Capacidade M\\u00E1xima\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(44, \"input\", 17);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(45, \"mat-form-field\", 7)(46, \"mat-label\");\n          i0.ɵɵtext(47, \"Imagem do Evento (URL)\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(48, \"input\", 18);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(49, EventoFormComponent_div_49_Template, 3, 0, \"div\", 19);\n          i0.ɵɵelementStart(50, \"mat-card-actions\", 20)(51, \"button\", 21);\n          i0.ɵɵtext(52);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(53, \"button\", 22);\n          i0.ɵɵlistener(\"click\", function EventoFormComponent_Template_button_click_53_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onCancel());\n          });\n          i0.ɵɵtext(54, \"Cancelar\");\n          i0.ɵɵelementEnd()()()()()()()();\n        }\n        if (rf & 2) {\n          let tmp_3_0;\n          const picker_r3 = i0.ɵɵreference(27);\n          i0.ɵɵadvance(6);\n          i0.ɵɵtextInterpolate(ctx.isEditMode ? \"Editar Evento\" : \"Novo Evento\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵtextInterpolate1(\" \", ctx.isEditMode ? \"Altere os dados do evento existente\" : \"Preencha os dados para cadastrar um novo evento\", \" \");\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", (tmp_3_0 = ctx.form.get(\"imagemUrl\")) == null ? null : tmp_3_0.value);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"formGroup\", ctx.form);\n          i0.ɵɵadvance(13);\n          i0.ɵɵproperty(\"matDatepicker\", picker_r3);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"for\", picker_r3);\n          i0.ɵɵadvance(24);\n          i0.ɵɵproperty(\"ngIf\", ctx.isEditMode);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"disabled\", ctx.form.invalid);\n          i0.ɵɵadvance();\n          i0.ɵɵtextInterpolate1(\" \", ctx.isEditMode ? \"Atualizar Evento\" : \"Salvar Evento\", \" \");\n        }\n      },\n      dependencies: [CommonModule, i4.NgIf, ReactiveFormsModule, i1.ɵNgNoValidate, i1.DefaultValueAccessor, i1.NumberValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName, MatFormFieldModule, i5.MatFormField, i5.MatLabel, i5.MatSuffix, MatInputModule, i6.MatInput, MatButtonModule, i7.MatButton, MatCardModule, i8.MatCard, i8.MatCardActions, i8.MatCardContent, i8.MatCardHeader, i8.MatCardSubtitle, i8.MatCardTitle, MatDatepickerModule, i9.MatDatepicker, i9.MatDatepickerInput, i9.MatDatepickerToggle, MatNativeDateModule, MatSlideToggleModule, i10.MatSlideToggle],\n      styles: [\".container[_ngcontent-%COMP%]{padding:2rem;max-width:1300px;margin:auto}.grid-layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1.3fr;gap:2rem}.event-form[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .6s ease-in-out}.full-width[_ngcontent-%COMP%]{width:100%}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:flex-start}.form-field-half[_ngcontent-%COMP%]{flex:1}.toggle-section[_ngcontent-%COMP%]{margin:16px 0}mat-card-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px}.eventos-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:1rem}.evento-card[_ngcontent-%COMP%]{position:relative;overflow:hidden;animation:_ngcontent-%COMP%_fadeIn .5s ease-in-out;display:flex;flex-direction:column;gap:.5rem;padding-bottom:1rem}.evento-thumb[_ngcontent-%COMP%]{width:100%;height:140px;object-fit:cover;border-radius:6px}.evento-imagem[_ngcontent-%COMP%]{width:100%;height:180px;object-fit:cover;border-radius:8px;margin:1rem 0}.animate-image[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInImage .8s ease-in-out}.evento-preco[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:#1976d2;margin-top:auto}.evento-acoes[_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:flex-end}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_fadeInImage{0%{opacity:0;transform:scale(1.05)}to{opacity:1;transform:scale(1)}}\"]\n    });\n  }\n  return EventoFormComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}