{"ast":null,"code":"import { CommonModule, formatDate } from \"@angular/common\";\nimport { ReactiveFormsModule, Validators } from \"@angular/forms\";\nimport { MatFormFieldModule } from \"@angular/material/form-field\";\nimport { MatInputModule } from \"@angular/material/input\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatCardModule } from \"@angular/material/card\";\nimport { MatDatepickerModule } from \"@angular/material/datepicker\";\nimport { MatNativeDateModule } from \"@angular/material/core\";\nimport { MatSlideToggleModule } from \"@angular/material/slide-toggle\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"./../services/eventos.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/material/form-field\";\nimport * as i6 from \"@angular/material/input\";\nimport * as i7 from \"@angular/material/button\";\nimport * as i8 from \"@angular/material/card\";\nimport * as i9 from \"@angular/material/datepicker\";\nimport * as i10 from \"@angular/material/slide-toggle\";\nfunction EventoFormComponent_mat_error_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Nome \\u00E9 obrigat\\u00F3rio e deve ter no m\\u00EDnimo 3 caracteres. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EventoFormComponent_mat_error_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Descri\\u00E7\\u00E3o \\u00E9 obrigat\\u00F3ria e deve ter no m\\u00EDnimo 10 caracteres. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EventoFormComponent_mat_error_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Data do evento \\u00E9 obrigat\\u00F3ria. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EventoFormComponent_mat_error_31_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Hora \\u00E9 obrigat\\u00F3ria. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EventoFormComponent_mat_error_36_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Local \\u00E9 obrigat\\u00F3rio e deve ter no m\\u00EDnimo 5 caracteres. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EventoFormComponent_mat_error_42_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Pre\\u00E7o \\u00E9 obrigat\\u00F3rio e n\\u00E3o pode ser negativo. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EventoFormComponent_mat_error_47_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Capacidade \\u00E9 obrigat\\u00F3ria e deve ser no m\\u00EDnimo 1. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EventoFormComponent_div_48_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18)(1, \"mat-slide-toggle\", 19);\n    i0.ɵɵtext(2, \" Evento Ativo \");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport let EventoFormComponent = /*#__PURE__*/(() => {\n  class EventoFormComponent {\n    fb;\n    eventoService;\n    router;\n    route;\n    form;\n    eventId = null;\n    isEditMode = false;\n    constructor(fb, eventoService, router, route) {\n      this.fb = fb;\n      this.eventoService = eventoService;\n      this.router = router;\n      this.route = route;\n    }\n    ngOnInit() {\n      this.form = this.fb.group({\n        nome: [\"\", [Validators.required, Validators.minLength(3)]],\n        descricao: [\"\", [Validators.required, Validators.minLength(10)]],\n        dataEvento: [null, [Validators.required]],\n        horaEvento: ['09:00', [Validators.required]],\n        local: [\"\", [Validators.required, Validators.minLength(5)]],\n        precoIngresso: [0, [Validators.required, Validators.min(0)]],\n        capacidadeMaxima: [1, [Validators.required, Validators.min(1)]],\n        ativo: [true]\n      });\n      const idParam = this.route.snapshot.paramMap.get('id');\n      if (idParam) {\n        this.isEditMode = true;\n        this.eventId = +idParam;\n        this.form.controls['ativo'].enable();\n        this.carregarDadosDoEvento(this.eventId);\n      } else {\n        this.isEditMode = false;\n        this.form.controls['ativo'].disable();\n      }\n    }\n    carregarDadosDoEvento(id) {\n      // Supondo que seu serviço tenha um método getEventoById que retorna ApiResponse<Evento>\n      this.eventoService.getEvento(id).subscribe({\n        next: response => {\n          if (response.sucesso && response.dados) {\n            const evento = response.dados;\n            this.form.patchValue({\n              nome: evento.nome,\n              descricao: evento.descricao,\n              dataEvento: evento.dataEvento,\n              local: evento.local,\n              precoIngresso: evento.precoIngresso,\n              capacidadeMaxima: evento.capacidadeMaxima,\n              ativo: evento.ativo\n            });\n            if (evento.dataEvento) {\n              this.form.controls['horaEvento'].setValue(formatDate(evento.dataEvento, 'HH:mm', 'en-US'));\n            }\n          } else {\n            console.error(\"Erro ao buscar dados do evento:\", response.mensagem);\n            this.router.navigate(['/eventos']);\n          }\n        },\n        error: err => {\n          console.error(\"Erro na requisição para buscar evento:\", err);\n          this.router.navigate(['/eventos']);\n        }\n      });\n    }\n    onSubmit() {\n      if (this.form.invalid) {\n        console.log(\"Formulário inválido.\");\n        this.form.markAllAsTouched();\n        return;\n      }\n      const formValues = this.form.value;\n      const dataSelecionada = new Date(formValues.dataEvento);\n      const [horas, minutos] = formValues.horaEvento.split(':').map(Number);\n      const dataEventoCompleta = new Date(dataSelecionada.getFullYear(), dataSelecionada.getMonth(), dataSelecionada.getDate(), horas, minutos);\n      // --- ADICIONADOS OS CONSOLE.LOGS PARA DEBUG ---\n      console.log(\"--- DEBUG SUBMIT (EDIÇÃO OU CRIAÇÃO) ---\");\n      console.log(\"Valor dataEvento do form (original):\", formValues.dataEvento);\n      console.log(\"Valor horaEvento do form:\", formValues.horaEvento);\n      console.log(\"Data selecionada (após new Date):\", dataSelecionada.toISOString(), dataSelecionada);\n      console.log(\"Horas parseadas:\", horas, \"Minutos parseados:\", minutos);\n      console.log(\"DataEventoCompleta a ser enviada (objeto Date):\", dataEventoCompleta);\n      console.log(\"DataEventoCompleta a ser enviada (ISO String):\", dataEventoCompleta.toISOString());\n      // --- FIM DOS CONSOLE.LOGS ---\n      if (this.isEditMode && this.eventId !== null) {\n        const eventoAtualizado = {\n          id: this.eventId,\n          nome: formValues.nome,\n          descricao: formValues.descricao,\n          dataEvento: dataEventoCompleta,\n          local: formValues.local,\n          precoIngresso: formValues.precoIngresso,\n          capacidadeMaxima: formValues.capacidadeMaxima,\n          ativo: formValues.ativo\n        };\n        // --- CONSOLE.LOG DO PAYLOAD DE ATUALIZAÇÃO ---\n        console.log(\"Payload enviado para atualizarEvento:\", eventoAtualizado);\n        // --- FIM DO CONSOLE.LOG ---\n        this.eventoService.atualizarEvento(this.eventId, eventoAtualizado).subscribe({\n          next: () => {\n            console.log(\"Evento atualizado com sucesso!\");\n            this.router.navigate(['/eventos']);\n          },\n          error: err => {\n            console.error(\"Erro ao atualizar evento:\", err);\n          }\n        });\n      } else {\n        const novoEvento = {\n          nome: formValues.nome,\n          descricao: formValues.descricao,\n          dataEvento: dataEventoCompleta,\n          local: formValues.local,\n          precoIngresso: formValues.precoIngresso,\n          capacidadeMaxima: formValues.capacidadeMaxima\n        };\n        // --- CONSOLE.LOG DO PAYLOAD DE CRIAÇÃO ---\n        console.log(\"Payload enviado para criarEvento:\", novoEvento);\n        // --- FIM DO CONSOLE.LOG ---\n        this.eventoService.criarEvento(novoEvento).subscribe({\n          next: () => {\n            console.log(\"Evento criado com sucesso!\");\n            this.router.navigate(['/eventos']);\n          },\n          error: err => {\n            console.error(\"Erro ao criar evento:\", err);\n          }\n        });\n      }\n    }\n    onCancel() {\n      this.router.navigate(['/eventos']);\n    }\n    static ɵfac = function EventoFormComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || EventoFormComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.EventosService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i3.ActivatedRoute));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: EventoFormComponent,\n      selectors: [[\"app-evento-form\"]],\n      decls: 54,\n      vars: 15,\n      consts: [[\"picker\", \"\"], [3, \"ngSubmit\", \"formGroup\"], [\"appearance\", \"fill\", 1, \"full-width\"], [\"matInput\", \"\", \"formControlName\", \"nome\", \"placeholder\", \"Ex: Show de Rock\"], [4, \"ngIf\"], [\"matInput\", \"\", \"formControlName\", \"descricao\", \"placeholder\", \"Descreva os detalhes do evento...\"], [1, \"form-row\"], [\"appearance\", \"fill\", 1, \"form-field-half\"], [\"matInput\", \"\", \"formControlName\", \"dataEvento\", 3, \"matDatepicker\"], [\"matSuffix\", \"\", 3, \"for\"], [\"matInput\", \"\", \"type\", \"time\", \"formControlName\", \"horaEvento\"], [\"matInput\", \"\", \"formControlName\", \"local\", \"placeholder\", \"Ex: Est\\u00E1dio Maracan\\u00E3\"], [\"matInput\", \"\", \"type\", \"number\", \"formControlName\", \"precoIngresso\", \"placeholder\", \"50.00\"], [\"matInput\", \"\", \"type\", \"number\", \"formControlName\", \"capacidadeMaxima\", \"placeholder\", \"1000\"], [\"class\", \"full-width toggle-section\", 4, \"ngIf\"], [\"align\", \"end\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"type\", \"submit\", 3, \"disabled\"], [\"mat-stroked-button\", \"\", \"color\", \"warn\", \"type\", \"button\", 3, \"click\"], [1, \"full-width\", \"toggle-section\"], [\"formControlName\", \"ativo\", \"color\", \"primary\"]],\n      template: function EventoFormComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"mat-card\")(1, \"mat-card-header\")(2, \"mat-card-title\");\n          i0.ɵɵtext(3);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(4, \"mat-card-subtitle\");\n          i0.ɵɵtext(5);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(6, \"mat-card-content\")(7, \"form\", 1);\n          i0.ɵɵlistener(\"ngSubmit\", function EventoFormComponent_Template_form_ngSubmit_7_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onSubmit());\n          });\n          i0.ɵɵelementStart(8, \"mat-form-field\", 2)(9, \"mat-label\");\n          i0.ɵɵtext(10, \"Nome do Evento\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(11, \"input\", 3);\n          i0.ɵɵtemplate(12, EventoFormComponent_mat_error_12_Template, 2, 0, \"mat-error\", 4);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(13, \"mat-form-field\", 2)(14, \"mat-label\");\n          i0.ɵɵtext(15, \"Descri\\u00E7\\u00E3o\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(16, \"textarea\", 5);\n          i0.ɵɵtemplate(17, EventoFormComponent_mat_error_17_Template, 2, 0, \"mat-error\", 4);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(18, \"div\", 6)(19, \"mat-form-field\", 7)(20, \"mat-label\");\n          i0.ɵɵtext(21, \"Data do Evento\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(22, \"input\", 8)(23, \"mat-datepicker-toggle\", 9)(24, \"mat-datepicker\", null, 0);\n          i0.ɵɵtemplate(26, EventoFormComponent_mat_error_26_Template, 2, 0, \"mat-error\", 4);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(27, \"mat-form-field\", 7)(28, \"mat-label\");\n          i0.ɵɵtext(29, \"Hora do Evento\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(30, \"input\", 10);\n          i0.ɵɵtemplate(31, EventoFormComponent_mat_error_31_Template, 2, 0, \"mat-error\", 4);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(32, \"mat-form-field\", 2)(33, \"mat-label\");\n          i0.ɵɵtext(34, \"Local\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(35, \"input\", 11);\n          i0.ɵɵtemplate(36, EventoFormComponent_mat_error_36_Template, 2, 0, \"mat-error\", 4);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(37, \"div\", 6)(38, \"mat-form-field\", 7)(39, \"mat-label\");\n          i0.ɵɵtext(40, \"Pre\\u00E7o do Ingresso (R$)\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(41, \"input\", 12);\n          i0.ɵɵtemplate(42, EventoFormComponent_mat_error_42_Template, 2, 0, \"mat-error\", 4);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(43, \"mat-form-field\", 7)(44, \"mat-label\");\n          i0.ɵɵtext(45, \"Capacidade M\\u00E1xima\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(46, \"input\", 13);\n          i0.ɵɵtemplate(47, EventoFormComponent_mat_error_47_Template, 2, 0, \"mat-error\", 4);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(48, EventoFormComponent_div_48_Template, 3, 0, \"div\", 14);\n          i0.ɵɵelementStart(49, \"mat-card-actions\", 15)(50, \"button\", 16);\n          i0.ɵɵtext(51);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(52, \"button\", 17);\n          i0.ɵɵlistener(\"click\", function EventoFormComponent_Template_button_click_52_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onCancel());\n          });\n          i0.ɵɵtext(53, \"Cancelar\");\n          i0.ɵɵelementEnd()()()()();\n        }\n        if (rf & 2) {\n          let tmp_4_0;\n          let tmp_5_0;\n          let tmp_8_0;\n          let tmp_9_0;\n          let tmp_10_0;\n          let tmp_11_0;\n          let tmp_12_0;\n          const picker_r2 = i0.ɵɵreference(25);\n          i0.ɵɵadvance(3);\n          i0.ɵɵtextInterpolate(ctx.isEditMode ? \"Editar Evento\" : \"Novo Evento\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵtextInterpolate1(\" \", ctx.isEditMode ? \"Altere os dados do evento existente\" : \"Preencha os dados para cadastrar um novo evento\", \" \");\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"formGroup\", ctx.form);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_4_0 = ctx.form.get(\"nome\")) == null ? null : tmp_4_0.invalid) && ((tmp_4_0 = ctx.form.get(\"nome\")) == null ? null : tmp_4_0.touched));\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_5_0 = ctx.form.get(\"descricao\")) == null ? null : tmp_5_0.invalid) && ((tmp_5_0 = ctx.form.get(\"descricao\")) == null ? null : tmp_5_0.touched));\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"matDatepicker\", picker_r2);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"for\", picker_r2);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_8_0 = ctx.form.get(\"dataEvento\")) == null ? null : tmp_8_0.invalid) && ((tmp_8_0 = ctx.form.get(\"dataEvento\")) == null ? null : tmp_8_0.touched));\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_9_0 = ctx.form.get(\"horaEvento\")) == null ? null : tmp_9_0.invalid) && ((tmp_9_0 = ctx.form.get(\"horaEvento\")) == null ? null : tmp_9_0.touched));\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_10_0 = ctx.form.get(\"local\")) == null ? null : tmp_10_0.invalid) && ((tmp_10_0 = ctx.form.get(\"local\")) == null ? null : tmp_10_0.touched));\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_11_0 = ctx.form.get(\"precoIngresso\")) == null ? null : tmp_11_0.invalid) && ((tmp_11_0 = ctx.form.get(\"precoIngresso\")) == null ? null : tmp_11_0.touched));\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_12_0 = ctx.form.get(\"capacidadeMaxima\")) == null ? null : tmp_12_0.invalid) && ((tmp_12_0 = ctx.form.get(\"capacidadeMaxima\")) == null ? null : tmp_12_0.touched));\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.isEditMode);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"disabled\", ctx.form.invalid);\n          i0.ɵɵadvance();\n          i0.ɵɵtextInterpolate1(\" \", ctx.isEditMode ? \"Atualizar Evento\" : \"Salvar Evento\", \" \");\n        }\n      },\n      dependencies: [CommonModule, i4.NgIf, ReactiveFormsModule, i1.ɵNgNoValidate, i1.DefaultValueAccessor, i1.NumberValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName, MatFormFieldModule, i5.MatFormField, i5.MatLabel, i5.MatError, i5.MatSuffix, MatInputModule, i6.MatInput, MatButtonModule, i7.MatButton, MatCardModule, i8.MatCard, i8.MatCardActions, i8.MatCardContent, i8.MatCardHeader, i8.MatCardSubtitle, i8.MatCardTitle, MatDatepickerModule, i9.MatDatepicker, i9.MatDatepickerInput, i9.MatDatepickerToggle, MatNativeDateModule, MatSlideToggleModule, i10.MatSlideToggle],\n      styles: [\".form-row[_ngcontent-%COMP%]{display:flex;gap:16px}.form-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1}mat-card-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;padding-right:0}.toggle-section[_ngcontent-%COMP%]{margin-bottom:16px;margin-top:8px}.full-width[_ngcontent-%COMP%]{width:100%}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:flex-start}.form-row[_ngcontent-%COMP%]   .form-field-half[_ngcontent-%COMP%]{flex:1}.toggle-section[_ngcontent-%COMP%]{margin-top:8px;margin-bottom:16px}mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:8px}mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{margin-left:0}\"]\n    });\n  }\n  return EventoFormComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}