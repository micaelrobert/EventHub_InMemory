{"ast":null,"code":"import { inject } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { MatTableModule } from \"@angular/material/table\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatIconModule } from \"@angular/material/icon\";\nimport { MatCardModule } from \"@angular/material/card\";\nimport { MatChipsModule } from \"@angular/material/chips\";\nimport { RouterModule } from \"@angular/router\";\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { MatDialog, MatDialogModule } from '@angular/material/dialog';\nimport { ComprarIngressoDialogComponent } from '../components/comprar-ingresso-dialog/comprar-ingresso-dialog.component';\nimport { EventosService } from \"../services/eventos.service\";\nimport { AuthService } from '../services/auth.service';\nimport { NotificationService } from '../services/notification.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/material/button\";\nimport * as i4 from \"@angular/material/icon\";\nimport * as i5 from \"@angular/material/card\";\nimport * as i6 from \"@angular/material/tooltip\";\nconst _c0 = a0 => [\"/eventos\", a0];\nconst _c1 = a0 => [\"/eventos/editar\", a0];\nfunction EventoListComponent_mat_card_10_a_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 12)(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"edit\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const evento_r3 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(1, _c1, evento_r3.id));\n  }\n}\nfunction EventoListComponent_mat_card_10_button_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function EventoListComponent_mat_card_10_button_15_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const evento_r3 = i0.ɵɵnextContext().$implicit;\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.deletar(evento_r3));\n    });\n    i0.ɵɵelementStart(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"delete\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction EventoListComponent_mat_card_10_button_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function EventoListComponent_mat_card_10_button_16_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const evento_r3 = i0.ɵɵnextContext().$implicit;\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.comprarIngresso(evento_r3));\n    });\n    i0.ɵɵelementStart(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"shopping_cart\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const evento_r3 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"disabled\", !evento_r3.ativo || evento_r3.ingressosDisponiveis === 0);\n  }\n}\nfunction EventoListComponent_mat_card_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"mat-card\", 2)(1, \"img\", 3);\n    i0.ɵɵlistener(\"error\", function EventoListComponent_mat_card_10_Template_img_error_1_listener($event) {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.handleImageError($event));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"mat-card-content\")(3, \"h3\", 4);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\", 5);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"p\", 6);\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"date\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"mat-card-actions\", 7)(11, \"a\", 8)(12, \"mat-icon\");\n    i0.ɵɵtext(13, \"visibility\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(14, EventoListComponent_mat_card_10_a_14_Template, 3, 3, \"a\", 9)(15, EventoListComponent_mat_card_10_button_15_Template, 3, 0, \"button\", 10)(16, EventoListComponent_mat_card_10_button_16_Template, 3, 1, \"button\", 11);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const evento_r3 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"src\", ctx_r1.getImagemEvento(evento_r3), i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(evento_r3.nome);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(evento_r3.local);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(9, 8, evento_r3.dataEvento, \"dd/MM/yyyy HH:mm\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(11, _c0, evento_r3.id));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.authService.isAdmin());\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.authService.isAdmin());\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.authService.isAdmin());\n  }\n}\nexport let EventoListComponent = /*#__PURE__*/(() => {\n  class EventoListComponent {\n    eventosService = inject(EventosService);\n    dialog = inject(MatDialog);\n    authService = inject(AuthService);\n    notificationService = inject(NotificationService);\n    eventos = [];\n    ngOnInit() {\n      this.carregarEventos();\n    }\n    carregarEventos() {\n      const loadObservable = this.authService.isAdmin() ? this.eventosService.getEventos() : this.eventosService.getEventosDisponiveis();\n      loadObservable.subscribe({\n        next: response => {\n          if (response.sucesso && response.dados) {\n            this.eventos = response.dados;\n          } else {\n            this.notificationService.error(response.mensagem || \"Falha ao carregar eventos.\");\n          }\n        },\n        error: err => {\n          this.notificationService.error(\"Erro de comunicação ao carregar eventos.\");\n          console.error(\"Erro ao carregar eventos:\", err);\n        }\n      });\n    }\n    getImagemEvento(evento) {\n      // Verifica se tem URL válida\n      if (evento.imagemUrl && evento.imagemUrl.trim() !== '') {\n        return evento.imagemUrl;\n      }\n      // Fallback para imagem padrão\n      return 'assets/imgs/evento-padrao.jpeg';\n    }\n    handleImageError(event) {\n      const imgElement = event.target;\n      imgElement.src = 'assets/imgs/evento-padrao.jpeg';\n    }\n    getStatusColor(evento) {\n      if (!evento.ativo) return \"warn\";\n      if (evento.ingressosDisponiveis === 0) return \"warn\";\n      if (evento.ingressosDisponiveis <= 10) return \"accent\";\n      return \"primary\";\n    }\n    deletar(evento) {\n      if (!this.authService.isAdmin()) {\n        this.notificationService.error(\"Ação não permitida.\");\n        return;\n      }\n      if (confirm(`Tem certeza que deseja deletar o evento \"${evento.nome}\"?`)) {\n        this.eventosService.deletarEvento(evento.id).subscribe({\n          next: response => {\n            if (response.sucesso) {\n              this.notificationService.success(\"Evento deletado com sucesso!\");\n              this.carregarEventos();\n            } else {\n              this.notificationService.error(response.mensagem || \"Não foi possível deletar o evento.\");\n            }\n          },\n          error: err => {\n            this.notificationService.error(\"Erro de comunicação ao tentar deletar o evento.\");\n            console.error(\"Erro ao deletar evento:\", err);\n          }\n        });\n      }\n    }\n    comprarIngresso(evento) {\n      this.dialog.open(ComprarIngressoDialogComponent, {\n        width: '500px',\n        maxWidth: '90vw',\n        // Adicionei isso para melhor responsividade\n        panelClass: 'modern-dialog',\n        // <<< ESTA É A LINHA QUE PRECISA SER ADICIONADA/VERIFICADA\n        data: {\n          evento\n        },\n        disableClose: true\n      });\n    }\n    static ɵfac = function EventoListComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || EventoListComponent)();\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: EventoListComponent,\n      selectors: [[\"app-evento-list\"]],\n      decls: 11,\n      vars: 1,\n      consts: [[1, \"event-card-grid\"], [\"class\", \"event-card\", \"matRipple\", \"\", 4, \"ngFor\", \"ngForOf\"], [\"matRipple\", \"\", 1, \"event-card\"], [\"mat-card-image\", \"\", \"alt\", \"Imagem do Evento\", 1, \"event-image\", 3, \"error\", \"src\"], [1, \"event-name\"], [1, \"event-location\"], [1, \"event-date\"], [\"align\", \"end\", 1, \"action-buttons\"], [\"mat-icon-button\", \"\", \"color\", \"primary\", \"matTooltip\", \"Ver detalhes\", 3, \"routerLink\"], [\"mat-icon-button\", \"\", \"color\", \"accent\", \"matTooltip\", \"Editar\", 3, \"routerLink\", 4, \"ngIf\"], [\"mat-icon-button\", \"\", \"color\", \"warn\", \"matTooltip\", \"Deletar\", 3, \"click\", 4, \"ngIf\"], [\"mat-icon-button\", \"\", \"color\", \"primary\", \"matTooltip\", \"Comprar\", 3, \"disabled\", \"click\", 4, \"ngIf\"], [\"mat-icon-button\", \"\", \"color\", \"accent\", \"matTooltip\", \"Editar\", 3, \"routerLink\"], [\"mat-icon-button\", \"\", \"color\", \"warn\", \"matTooltip\", \"Deletar\", 3, \"click\"], [\"mat-icon-button\", \"\", \"color\", \"primary\", \"matTooltip\", \"Comprar\", 3, \"click\", \"disabled\"]],\n      template: function EventoListComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"mat-card\")(1, \"mat-card-header\")(2, \"mat-card-title\")(3, \"mat-icon\");\n          i0.ɵɵtext(4, \"event\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtext(5, \" Eventos Dispon\\u00EDveis \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(6, \"mat-card-subtitle\");\n          i0.ɵɵtext(7, \"Explore os eventos e clique para ver os detalhes\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(8, \"mat-card-content\")(9, \"div\", 0);\n          i0.ɵɵtemplate(10, EventoListComponent_mat_card_10_Template, 17, 13, \"mat-card\", 1);\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(10);\n          i0.ɵɵproperty(\"ngForOf\", ctx.eventos);\n        }\n      },\n      dependencies: [CommonModule, i1.NgForOf, i1.NgIf, i1.DatePipe, RouterModule, i2.RouterLink, MatTableModule, MatButtonModule, i3.MatIconAnchor, i3.MatIconButton, MatIconModule, i4.MatIcon, MatCardModule, i5.MatCard, i5.MatCardActions, i5.MatCardContent, i5.MatCardHeader, i5.MatCardImage, i5.MatCardSubtitle, i5.MatCardTitle, MatChipsModule, MatTooltipModule, i6.MatTooltip, MatDialogModule],\n      styles: [\".dialog-header[_ngcontent-%COMP%]{padding:24px;position:relative;border-bottom:1px solid #eee;flex-shrink:0}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;color:#333;font-weight:600}.dialog-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0 0;color:#666;font-size:.9rem}.close-btn[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;color:#666;z-index:10}.dialog-content-scrollable[_ngcontent-%COMP%]{padding:24px;display:flex;flex-direction:column;min-height:0}.event-info[_ngcontent-%COMP%], .purchase-form[_ngcontent-%COMP%], .total-section[_ngcontent-%COMP%]{margin-bottom:20px}.dialog-content-scrollable[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:last-child{margin-bottom:0}.event-info[_ngcontent-%COMP%]{display:flex;gap:15px;align-items:flex-start;background-color:#f9f9f9;border-radius:8px;padding:15px;box-shadow:0 2px 5px #0000000d;flex-shrink:0}.event-image[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:8px;overflow:hidden;flex-shrink:0}.event-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.event-details[_ngcontent-%COMP%]{flex:1;min-width:0}.event-details-name[_ngcontent-%COMP%]{margin:0 0 8px;font-size:1.1rem;font-weight:600;color:#333}.detail[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:4px;font-size:.85rem;color:#555}.detail[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;margin-right:6px;color:#666}.price[_ngcontent-%COMP%]{margin-top:10px;font-weight:700;font-size:1rem;color:#333}.price[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:400;font-size:.8rem;color:#666}.purchase-form[_ngcontent-%COMP%]{display:grid;gap:15px;flex-shrink:0}.mat-mdc-form-field[_ngcontent-%COMP%]{width:100%}.total-section[_ngcontent-%COMP%]{border-top:1px solid #eee;padding-top:15px;flex-shrink:0}.total-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:8px;font-size:.95rem;color:#333}.total-row.final[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem;margin-top:10px;padding-top:10px;border-top:1px dashed #ddd;color:#1a1a1a}mat-dialog-actions[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid #eee;flex-shrink:0}@media (max-width: 600px){.event-info[_ngcontent-%COMP%]{flex-direction:column;text-align:center}.event-image[_ngcontent-%COMP%]{width:100%;height:150px;margin-bottom:10px}.event-details[_ngcontent-%COMP%]{align-items:center}.detail[_ngcontent-%COMP%]{justify-content:center}.dialog-header[_ngcontent-%COMP%], .dialog-content-scrollable[_ngcontent-%COMP%], mat-dialog-actions[_ngcontent-%COMP%]{padding:16px}}\"]\n    });\n  }\n  return EventoListComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}