{"ast":null,"code":"import { CommonModule } from \"@angular/common\";\nimport { ReactiveFormsModule, Validators } from \"@angular/forms\";\nimport { MatFormFieldModule } from \"@angular/material/form-field\";\nimport { MatInputModule } from \"@angular/material/input\";\nimport { MatButtonModule } from \"@angular/material/button\";\nimport { MatCardModule } from \"@angular/material/card\";\nimport { MatDatepickerModule } from \"@angular/material/datepicker\";\nimport { MatNativeDateModule } from \"@angular/material/core\";\nimport { MatSlideToggleModule } from \"@angular/material/slide-toggle\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"./../services/eventos.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/material/form-field\";\nimport * as i5 from \"@angular/material/input\";\nimport * as i6 from \"@angular/material/button\";\nimport * as i7 from \"@angular/material/card\";\nimport * as i8 from \"@angular/material/datepicker\";\nexport let EventoFormComponent = /*#__PURE__*/(() => {\n  class EventoFormComponent {\n    fb;\n    eventoService;\n    router;\n    route;\n    // As variáveis de serviço agora são declaradas no construtor\n    form;\n    eventId = null;\n    isEditMode = false;\n    eventoAtual;\n    // <<< MUDANÇA PRINCIPAL AQUI: INJETAR VIA CONSTRUTOR >>>\n    constructor(fb, eventoService, router, route) {\n      this.fb = fb;\n      this.eventoService = eventoService;\n      this.router = router;\n      this.route = route;\n    }\n    ngOnInit() {\n      // A inicialização do formulário continua aqui, usando this.fb\n      this.form = this.fb.group({\n        nome: [\"\", [Validators.required, Validators.minLength(3)]],\n        descricao: [\"\", [Validators.required, Validators.minLength(10)]],\n        dataEvento: [null, [Validators.required]],\n        local: [\"\", [Validators.required, Validators.minLength(5)]],\n        precoIngresso: [0, [Validators.required, Validators.min(0)]],\n        capacidadeMaxima: [1, [Validators.required, Validators.min(1)]],\n        ativo: [true]\n      });\n      const idParam = this.route.snapshot.paramMap.get('id');\n      if (idParam) {\n        this.isEditMode = true;\n        this.eventId = +idParam;\n        this.form.controls['ativo'].enable();\n        this.carregarDadosDoEvento(this.eventId);\n      } else {\n        this.isEditMode = false;\n        this.form.controls['ativo'].disable();\n      }\n    }\n    carregarDadosDoEvento(id) {\n      this.eventoService.getEvento(id).subscribe({\n        next: response => {\n          if (response.sucesso && response.dados) {\n            this.eventoAtual = response.dados;\n            this.form.patchValue(response.dados);\n          } else {\n            console.error(\"Erro ao buscar dados do evento:\", response.mensagem);\n            this.router.navigate(['/eventos']);\n          }\n        },\n        error: err => {\n          console.error(\"Erro na requisição para buscar evento:\", err);\n          this.router.navigate(['/eventos']);\n        }\n      });\n    }\n    onSubmit() {\n      if (this.form.invalid) {\n        console.log(\"Formulário inválido.\");\n        return;\n      }\n      if (this.isEditMode && this.eventId !== null) {\n        const eventoAtualizado = {\n          id: this.eventId,\n          ...this.form.value\n        };\n        this.eventoService.atualizarEvento(this.eventId, eventoAtualizado).subscribe({\n          next: () => {\n            console.log(\"Evento atualizado com sucesso!\");\n            this.router.navigate(['/eventos']);\n          },\n          error: err => {\n            console.error(\"Erro ao atualizar evento:\", err);\n          }\n        });\n      } else {\n        const novoEvento = this.form.value;\n        this.eventoService.criarEvento(novoEvento).subscribe({\n          next: () => {\n            console.log(\"Evento criado com sucesso!\");\n            this.router.navigate(['/eventos']);\n          },\n          error: err => {\n            console.error(\"Erro ao criar evento:\", err);\n          }\n        });\n      }\n    }\n    onCancel() {\n      this.router.navigate(['/eventos']);\n    }\n    static ɵfac = function EventoFormComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || EventoFormComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.EventosService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i3.ActivatedRoute));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: EventoFormComponent,\n      selectors: [[\"app-evento-form\"]],\n      decls: 41,\n      vars: 4,\n      consts: [[\"picker\", \"\"], [3, \"ngSubmit\", \"formGroup\"], [\"appearance\", \"fill\", 1, \"full-width\"], [\"matInput\", \"\", \"formControlName\", \"nome\", \"placeholder\", \"Ex: Show de Rock\"], [\"matInput\", \"\", \"formControlName\", \"descricao\", \"placeholder\", \"Descreva os detalhes do evento...\"], [\"matInput\", \"\", \"formControlName\", \"dataEvento\", 3, \"matDatepicker\"], [\"matSuffix\", \"\", 3, \"for\"], [\"matInput\", \"\", \"formControlName\", \"local\", \"placeholder\", \"Ex: Est\\u00E1dio Maracan\\u00E3\"], [1, \"form-row\"], [\"appearance\", \"fill\"], [\"matInput\", \"\", \"type\", \"number\", \"formControlName\", \"precoIngresso\", \"placeholder\", \"50.00\"], [\"matInput\", \"\", \"type\", \"number\", \"formControlName\", \"capacidadeMaxima\", \"placeholder\", \"1000\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"type\", \"submit\", 3, \"disabled\"], [\"mat-stroked-button\", \"\", \"color\", \"warn\", \"type\", \"button\", 3, \"click\"]],\n      template: function EventoFormComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"mat-card\")(1, \"mat-card-header\")(2, \"mat-card-title\");\n          i0.ɵɵtext(3, \"Novo Evento\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(4, \"mat-card-subtitle\");\n          i0.ɵɵtext(5, \"Preencha os dados para cadastrar um novo evento\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(6, \"mat-card-content\")(7, \"form\", 1);\n          i0.ɵɵlistener(\"ngSubmit\", function EventoFormComponent_Template_form_ngSubmit_7_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onSubmit());\n          });\n          i0.ɵɵelementStart(8, \"mat-form-field\", 2)(9, \"mat-label\");\n          i0.ɵɵtext(10, \"Nome do Evento\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(11, \"input\", 3);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(12, \"mat-form-field\", 2)(13, \"mat-label\");\n          i0.ɵɵtext(14, \"Descri\\u00E7\\u00E3o\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(15, \"textarea\", 4);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(16, \"mat-form-field\", 2)(17, \"mat-label\");\n          i0.ɵɵtext(18, \"Data do Evento\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(19, \"input\", 5)(20, \"mat-datepicker-toggle\", 6)(21, \"mat-datepicker\", null, 0);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(23, \"mat-form-field\", 2)(24, \"mat-label\");\n          i0.ɵɵtext(25, \"Local\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(26, \"input\", 7);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(27, \"div\", 8)(28, \"mat-form-field\", 9)(29, \"mat-label\");\n          i0.ɵɵtext(30, \"Pre\\u00E7o do Ingresso (R$)\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(31, \"input\", 10);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(32, \"mat-form-field\", 9)(33, \"mat-label\");\n          i0.ɵɵtext(34, \"Capacidade M\\u00E1xima\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(35, \"input\", 11);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(36, \"mat-card-actions\")(37, \"button\", 12);\n          i0.ɵɵtext(38, \"Salvar\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(39, \"button\", 13);\n          i0.ɵɵlistener(\"click\", function EventoFormComponent_Template_button_click_39_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onCancel());\n          });\n          i0.ɵɵtext(40, \"Cancelar\");\n          i0.ɵɵelementEnd()()()()();\n        }\n        if (rf & 2) {\n          const picker_r2 = i0.ɵɵreference(22);\n          i0.ɵɵadvance(7);\n          i0.ɵɵproperty(\"formGroup\", ctx.form);\n          i0.ɵɵadvance(12);\n          i0.ɵɵproperty(\"matDatepicker\", picker_r2);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"for\", picker_r2);\n          i0.ɵɵadvance(17);\n          i0.ɵɵproperty(\"disabled\", !ctx.form.valid);\n        }\n      },\n      dependencies: [CommonModule, ReactiveFormsModule, i1.ɵNgNoValidate, i1.DefaultValueAccessor, i1.NumberValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName, MatFormFieldModule, i4.MatFormField, i4.MatLabel, i4.MatSuffix, MatInputModule, i5.MatInput, MatButtonModule, i6.MatButton, MatCardModule, i7.MatCard, i7.MatCardActions, i7.MatCardContent, i7.MatCardHeader, i7.MatCardSubtitle, i7.MatCardTitle, MatDatepickerModule, i8.MatDatepicker, i8.MatDatepickerInput, i8.MatDatepickerToggle, MatNativeDateModule, MatSlideToggleModule],\n      styles: [\".full-width[_ngcontent-%COMP%]{width:100%}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px}.form-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1}mat-card-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;padding-right:0}\"]\n    });\n  }\n  return EventoFormComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}